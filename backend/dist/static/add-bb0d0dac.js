import{d as e,u as a,s,r as l,W as t,ax as p,o as i,i as o,w as r,e as m,a as d,x as u,L as n,P as c,y as f,_ as g}from"./index-14c99acf.js";import{C as N}from"./ContentDetailWrap-01c6e33b.js";import{u as k}from"./useEmitt-24a6498c.js";import{u as b,c as v,d as _}from"./index-1dc4238d.js";import{E as j,a as h}from"./el-form-item-6a11bdc7.js";import{E as y}from"./el-button-b39417c4.js";import{E as w}from"./el-input-90f914cc.js";import"./el-card-280f93ab.js";import"./index-a4774437.js";import"./use-form-common-props-d73423f8.js";import"./use-form-item-95457b9b.js";import"./event-5568c9d8.js";import"./isNil-1f22f7b0.js";const V=g(e({__name:"add",setup(e){const{push:g,go:V}=a(),{emitter:x}=k(),q=s({apkName:[{required:!0,message:"Apk name is required",trigger:"blur"}],appName:[{required:!0,message:"App name is required",trigger:"blur"}],pages:[{required:!0,message:"Pages are required",trigger:"blur"}]}),z=l(),{query:C}=t(),A=l(!1),E=l(!1),F=s({apkName:"",appName:"",pages:""});return C.id&&(async()=>{E.value=!0;const e=await _({id:C.id});e&&(F.apkName=e.apkName,F.appName=e.appName,F.pages=e.pages.reduce(((e,a)=>e+",\n"+a)),E.value=!1)})(),(e,a)=>{const s=p("loading");return i(),o(d(N),{title:d(C).id?"编辑":"页面映射新增",onBack:a[6]||(a[6]=e=>d(g)("/localization/page-map"))},{header:r((()=>[m(d(y),{onClick:a[0]||(a[0]=e=>d(V)(-1))},{default:r((()=>[u("返回")])),_:1})])),default:r((()=>[n((i(),o(d(j),{ref_key:"ruleFormRef",ref:z,model:F,rules:q,"label-width":"120px",class:"demo-ruleForm",size:"default","status-icon":""},{default:r((()=>[m(d(h),{label:"包名",prop:"apkName"},{default:r((()=>[m(d(w),{modelValue:F.apkName,"onUpdate:modelValue":a[1]||(a[1]=e=>F.apkName=e),class:"width-190",placeholder:"请输入包名",disabled:!!d(C).id},null,8,["modelValue","disabled"])])),_:1}),m(d(h),{label:"应用名称",prop:"appName"},{default:r((()=>[m(d(w),{modelValue:F.appName,"onUpdate:modelValue":a[2]||(a[2]=e=>F.appName=e),class:"width-190",placeholder:"请输入应用名称"},null,8,["modelValue"])])),_:1}),c(' <el-form-item label="状态" prop="status">\n        <el-input v-model="ruleForm.status" class="width-190" />\n      </el-form-item> '),m(d(h),{label:"页面列表",prop:"pages"},{default:r((()=>[m(d(w),{modelValue:F.pages,"onUpdate:modelValue":a[3]||(a[3]=e=>F.pages=e),class:"width-190",placeholder:"多个页面请用逗号隔开",type:"textarea",autosize:""},null,8,["modelValue"])])),_:1}),m(d(h),null,{default:r((()=>[m(d(y),{type:"primary",onClick:a[4]||(a[4]=e=>(async e=>{e&&await e.validate((async(e,a)=>{if(e){console.log("submit!",F.pages,F.pages.split(","));const e=F.pages.split(",").map((e=>e.trim()));console.log(e),A.value=!0;const a={apkName:F.apkName,appName:F.appName,pages:e};let s;if(C.id){const a={id:Number(C.id),appName:F.appName,pages:e};s=await b(a).catch((()=>{})).finally((()=>{A.value=!1}))}else s=await v(a).catch((()=>{})).finally((()=>{A.value=!1}));s&&(f.success(C.id?"更新成功":"保存成功"),x.emit("getApkList","add"),g("/localization/page-map"))}else console.log("error submit!",a)}))})(z.value))},{default:r((()=>[u("保存")])),_:1}),d(C).id?c("v-if",!0):(i(),o(d(y),{key:0,onClick:a[5]||(a[5]=e=>{var a;(a=z.value)&&a.resetFields()})},{default:r((()=>[u("重置")])),_:1}))])),_:1})])),_:1},8,["model","rules"])),[[s,E.value]])])),_:1},8,["title"])}}}),[["__file","/Users/zyb-dong/github/project425/fontend/src/views/PageMap/add.vue"]]);export{V as default};
