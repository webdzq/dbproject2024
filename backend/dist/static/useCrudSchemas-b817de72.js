import{Y as e,A as a,Z as t,$ as l,a0 as n,d as o,a1 as s,a2 as i,a3 as r,I as c,H as d,a4 as u,r as f,a5 as p,a6 as m,G as v,V as h,a7 as g,a8 as y,o as b,i as w,e as x,w as S,f as k,n as O,a as C,a9 as z,N as j,P as A,C as E,D as L,c as I,F as T,aa as _,ab as R,ac as N,ad as F,ae as P,af as $,ag as M,U as B,L as D,Q as Y,O as V,h as W,R as X,B as q,ah as H,ai as K,aj as U,S as G,ak as Q,al as Z,t as J,M as ee,am as ae,an as te,ao as le,ap as ne,K as oe,aq as se,j as ie,v as re,ar as ce,k as de,x as ue,as as fe,at as pe,au as me,av as ve,aw as he,ax as ge,b as ye,ay as be,az as we,y as xe,s as Se}from"./index-d5304777.js";import{E as ke}from"./el-card-2b130a3f.js";import{E as Oe}from"./el-popper-20328552.js";import{i as Ce,u as ze,a as je,F as Ae,g as Ee}from"./useForm-aca3a07d.js";import{E as Le}from"./el-button-7384c59f.js";import{E as Ie,a as Te}from"./el-table-column-0c648863.js";import{d as _e}from"./el-checkbox-b2c1ef9f.js";import"./el-tag-377e0f90.js";import{E as Re}from"./el-pagination-60cf2577.js";import{u as Ne}from"./el-input-18a8a90e.js";import"./el-select-ce060cba.js";import{a as Fe,b as Pe,c as $e,E as Me,t as Be,f as De,e as Ye}from"./tree-05cd14e5.js";import{g as Ve}from"./scroll-8db753ac.js";import"./el-overlay-cfbba524.js";function We(a,t,l){var n=!0,o=!0;if("function"!=typeof a)throw new TypeError("Expected a function");return e(l)&&(n="leading"in l?!!l.leading:n,o="trailing"in l?!!l.trailing:o),_e(a,t,{leading:n,maxWait:t,trailing:o})}const Xe=a({urlList:{type:t(Array),default:()=>l([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),qe={close:()=>!0,switch:e=>n(e)},He=["src"],Ke=o({name:"ElImageViewer"});const Ue=G(q(o({...Ke,props:Xe,emits:qe,setup(e,{expose:a,emit:t}){const l=e,o={CONTAIN:{name:"contain",icon:s(i)},ORIGINAL:{name:"original",icon:s(r)}},{t:q}=c(),G=d("image-viewer"),{nextZIndex:Q}=u(),Z=f(),J=f([]),ee=p(),ae=f(!0),te=f(l.initialIndex),le=m(o.CONTAIN),ne=f({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),oe=v((()=>{const{urlList:e}=l;return e.length<=1})),se=v((()=>0===te.value)),ie=v((()=>te.value===l.urlList.length-1)),re=v((()=>l.urlList[te.value])),ce=v((()=>[G.e("btn"),G.e("prev"),G.is("disabled",!l.infinite&&se.value)])),de=v((()=>[G.e("btn"),G.e("next"),G.is("disabled",!l.infinite&&ie.value)])),ue=v((()=>{const{scale:e,deg:a,offsetX:t,offsetY:l,enableTransition:n}=ne.value;let s=t/e,i=l/e;switch(a%360){case 90:case-270:[s,i]=[i,-s];break;case 180:case-180:[s,i]=[-s,-i];break;case 270:case-90:[s,i]=[-i,s]}const r={transform:`scale(${e}) rotate(${a}deg) translate(${s}px, ${i}px)`,transition:n?"transform .3s":""};return le.value.name===o.CONTAIN.name&&(r.maxWidth=r.maxHeight="100%"),r})),fe=v((()=>n(l.zIndex)?l.zIndex:Q()));function pe(){ee.stop(),t("close")}function me(){ae.value=!1}function ve(e){ae.value=!1,e.target.alt=q("el.image.error")}function he(e){if(ae.value||0!==e.button||!Z.value)return;ne.value.enableTransition=!1;const{offsetX:a,offsetY:t}=ne.value,l=e.pageX,n=e.pageY,o=We((e=>{ne.value={...ne.value,offsetX:a+e.pageX-l,offsetY:t+e.pageY-n}})),s=H(document,"mousemove",o);H(document,"mouseup",(()=>{s()})),e.preventDefault()}function ge(){ne.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function ye(){if(ae.value)return;const e=U(o),a=Object.values(o),t=le.value.name,l=(a.findIndex((e=>e.name===t))+1)%e.length;le.value=o[e[l]],ge()}function be(e){const a=l.urlList.length;te.value=(e+a)%a}function we(){se.value&&!l.infinite||be(te.value-1)}function xe(){ie.value&&!l.infinite||be(te.value+1)}function Se(e,a={}){if(ae.value)return;const{zoomRate:t,rotateDeg:n,enableTransition:o}={zoomRate:l.zoomRate,rotateDeg:90,enableTransition:!0,...a};switch(e){case"zoomOut":ne.value.scale>.2&&(ne.value.scale=Number.parseFloat((ne.value.scale/t).toFixed(3)));break;case"zoomIn":ne.value.scale<7&&(ne.value.scale=Number.parseFloat((ne.value.scale*t).toFixed(3)));break;case"clockwise":ne.value.deg+=n;break;case"anticlockwise":ne.value.deg-=n}ne.value.enableTransition=o}return h(re,(()=>{g((()=>{const e=J.value[0];(null==e?void 0:e.complete)||(ae.value=!0)}))})),h(te,(e=>{ge(),t("switch",e)})),y((()=>{var e,a;!function(){const e=We((e=>{switch(e.code){case K.esc:l.closeOnPressEscape&&pe();break;case K.space:ye();break;case K.left:we();break;case K.up:Se("zoomIn");break;case K.right:xe();break;case K.down:Se("zoomOut")}})),a=We((e=>{Se((e.deltaY||e.deltaX)<0?"zoomIn":"zoomOut",{zoomRate:l.zoomRate,enableTransition:!1})}));ee.run((()=>{H(document,"keydown",e),H(document,"wheel",a)}))}(),null==(a=null==(e=Z.value)?void 0:e.focus)||a.call(e)})),a({setActiveItem:be}),(e,a)=>(b(),w(X,{to:"body",disabled:!e.teleported},[x(W,{name:"viewer-fade",appear:""},{default:S((()=>[k("div",{ref_key:"wrapper",ref:Z,tabindex:-1,class:O(C(G).e("wrapper")),style:z({zIndex:C(fe)})},[k("div",{class:O(C(G).e("mask")),onClick:a[0]||(a[0]=j((a=>e.hideOnClickModal&&pe()),["self"]))},null,2),A(" CLOSE "),k("span",{class:O([C(G).e("btn"),C(G).e("close")]),onClick:pe},[x(C(E),null,{default:S((()=>[x(C(L))])),_:1})],2),A(" ARROW "),C(oe)?A("v-if",!0):(b(),I(T,{key:0},[k("span",{class:O(C(ce)),onClick:we},[x(C(E),null,{default:S((()=>[x(C(_))])),_:1})],2),k("span",{class:O(C(de)),onClick:xe},[x(C(E),null,{default:S((()=>[x(C(R))])),_:1})],2)],64)),A(" ACTIONS "),k("div",{class:O([C(G).e("btn"),C(G).e("actions")])},[k("div",{class:O(C(G).e("actions__inner"))},[x(C(E),{onClick:a[1]||(a[1]=e=>Se("zoomOut"))},{default:S((()=>[x(C(N))])),_:1}),x(C(E),{onClick:a[2]||(a[2]=e=>Se("zoomIn"))},{default:S((()=>[x(C(F))])),_:1}),k("i",{class:O(C(G).e("actions__divider"))},null,2),x(C(E),{onClick:ye},{default:S((()=>[(b(),w(P(C(le).icon)))])),_:1}),k("i",{class:O(C(G).e("actions__divider"))},null,2),x(C(E),{onClick:a[3]||(a[3]=e=>Se("anticlockwise"))},{default:S((()=>[x(C($))])),_:1}),x(C(E),{onClick:a[4]||(a[4]=e=>Se("clockwise"))},{default:S((()=>[x(C(M))])),_:1})],2)],2),A(" CANVAS "),k("div",{class:O(C(G).e("canvas"))},[(b(!0),I(T,null,B(e.urlList,((e,a)=>D((b(),I("img",{ref_for:!0,ref:e=>J.value[a]=e,key:e,src:e,style:z(C(ue)),class:O(C(G).e("img")),onLoad:me,onError:ve,onMousedown:he},null,46,He)),[[Y,a===te.value]]))),128))],2),V(e.$slots,"default")],6)])),_:3})],8,["disabled"]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]])),Ge=a({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:t([String,Object])},previewSrcList:{type:t(Array),default:()=>l([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),Qe={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:e=>n(e),close:()=>!0,show:()=>!0},Ze=["src","loading"],Je={key:0},ea=o({name:"ElImage",inheritAttrs:!1});const aa=G(q(o({...ea,props:Ge,emits:Qe,setup(e,{emit:a}){const t=e;let l="";const{t:n}=c(),o=d("image"),s=Q(),i=Ne(),r=f(),u=f(!1),p=f(!0),m=f(!1),x=f(),j=f(),E=Z&&"loading"in HTMLImageElement.prototype;let L,_;const R=v((()=>[o.e("inner"),P.value&&o.e("preview"),p.value&&o.is("loading")])),N=v((()=>s.style)),F=v((()=>{const{fit:e}=t;return Z&&e?{objectFit:e}:{}})),P=v((()=>{const{previewSrcList:e}=t;return Array.isArray(e)&&e.length>0})),$=v((()=>{const{previewSrcList:e,initialIndex:a}=t;let l=a;return a>e.length-1&&(l=0),l})),M=v((()=>"eager"!==t.loading&&(!E&&"lazy"===t.loading||t.lazy))),B=()=>{Z&&(p.value=!0,u.value=!1,r.value=t.src)};function D(e){p.value=!1,u.value=!1,a("load",e)}function Y(e){p.value=!1,u.value=!0,a("error",e)}function W(){Ce(x.value,j.value)&&(B(),K())}const X=le(W,200,!0);async function q(){var e;if(!Z)return;await g();const{scrollContainer:a}=t;ae(a)?j.value=a:te(a)&&""!==a?j.value=null!=(e=document.querySelector(a))?e:void 0:x.value&&(j.value=Ve(x.value)),j.value&&(L=H(j,"scroll",X),setTimeout((()=>W()),100))}function K(){Z&&j.value&&X&&(null==L||L(),j.value=void 0)}function U(e){if(e.ctrlKey)return e.deltaY<0||e.deltaY>0?(e.preventDefault(),!1):void 0}function G(){P.value&&(_=H("wheel",U,{passive:!1}),l=document.body.style.overflow,document.body.style.overflow="hidden",m.value=!0,a("show"))}function ne(){null==_||_(),document.body.style.overflow=l,m.value=!1,a("close")}function oe(e){a("switch",e)}return h((()=>t.src),(()=>{M.value?(p.value=!0,u.value=!1,K(),q()):B()})),y((()=>{M.value?q():B()})),(e,a)=>(b(),I("div",{ref_key:"container",ref:x,class:O([C(o).b(),e.$attrs.class]),style:z(C(N))},[u.value?V(e.$slots,"error",{key:0},(()=>[k("div",{class:O(C(o).e("error"))},J(C(n)("el.image.error")),3)])):(b(),I(T,{key:1},[void 0!==r.value?(b(),I("img",ee({key:0},C(i),{src:r.value,loading:e.loading,style:C(F),class:C(R),onClick:G,onLoad:D,onError:Y}),null,16,Ze)):A("v-if",!0),p.value?(b(),I("div",{key:1,class:O(C(o).e("wrapper"))},[V(e.$slots,"placeholder",{},(()=>[k("div",{class:O(C(o).e("placeholder"))},null,2)]))],2)):A("v-if",!0)],64)),C(P)?(b(),I(T,{key:2},[m.value?(b(),w(C(Ue),{key:0,"z-index":e.zIndex,"initial-index":C($),infinite:e.infinite,"zoom-rate":e.zoomRate,"url-list":e.previewSrcList,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:ne,onSwitch:oe},{default:S((()=>[e.$slots.viewer?(b(),I("div",Je,[V(e.$slots,"viewer")])):A("v-if",!0)])),_:3},8,["z-index","initial-index","infinite","zoom-rate","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):A("v-if",!0)],64)):A("v-if",!0)],6))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]])),ta={class:"flex items-center"},la={class:"text-16px font-700"},na={class:"max-w-200px"},oa=o({__name:"ContentWrap",props:{title:ne.string.def(""),message:ne.string.def("")},setup(e){const{getPrefixCls:a}=ie(),t=a("content-wrap");return(a,l)=>{const n=oe("Icon");return b(),w(C(ke),{class:O([C(t)]),shadow:"never"},se({default:S((()=>[k("div",null,[V(a.$slots,"default")])])),_:2},[e.title?{name:"header",fn:S((()=>[k("div",ta,[k("span",la,J(e.title),1),e.message?(b(),w(C(Oe),{key:0,effect:"dark",placement:"right"},{content:S((()=>[k("div",na,J(e.message),1)])),default:S((()=>[x(n,{class:"ml-5px",icon:"bi:question-circle-fill",size:14})])),_:1})):A("",!0)])])),key:"0"}:void 0]),1032,["class"])}}}),sa=e=>re(ce,e),ia=o({__name:"ActionButton",props:{showSearch:ne.bool.def(!0),showReset:ne.bool.def(!0),showExpand:ne.bool.def(!1),visible:ne.bool.def(!0),searchLoading:ne.bool.def(!1),resetLoading:ne.bool.def(!1)},emits:["search","reset","expand"],setup(e,{emit:a}){const{t:t}=de(),l=()=>{a("search")},n=()=>{a("reset")},o=()=>{a("expand")};return(a,s)=>(b(),I(T,null,[e.showSearch?(b(),w(C(Le),{key:0,type:"primary",loading:e.searchLoading,icon:C(sa)({icon:"ep:search"}),onClick:l},{default:S((()=>[ue(J(C(t)("common.query")),1)])),_:1},8,["loading","icon"])):A("",!0),e.showReset?(b(),w(C(Le),{key:1,loading:e.resetLoading,icon:C(sa)({icon:"ep:refresh-right"}),onClick:n},{default:S((()=>[ue(J(C(t)("common.reset")),1)])),_:1},8,["loading","icon"])):A("",!0),e.showExpand?(b(),w(C(Le),{key:2,icon:C(sa)({icon:e.visible?"ep:arrow-down":"ep:arrow-up"}),text:"",onClick:o},{default:S((()=>[ue(J(C(t)(e.visible?"common.shrink":"common.expand")),1)])),_:1},8,["icon"])):A("",!0)],64))}}),ra=o({__name:"Search",props:{schema:{type:Array,default:()=>[]},isCol:ne.bool.def(!1),labelWidth:ne.oneOfType([String,Number]).def("auto"),layout:ne.string.validate((e=>["inline","bottom"].includes(e))).def("inline"),buttonPosition:ne.string.validate((e=>["left","center","right"].includes(e))).def("center"),showSearch:ne.bool.def(!0),showReset:ne.bool.def(!0),showExpand:ne.bool.def(!1),expandField:ne.string.def(""),inline:ne.bool.def(!0),removeNoValueItem:ne.bool.def(!0),model:{type:Object,default:()=>({})},searchLoading:ne.bool.def(!1),resetLoading:ne.bool.def(!1)},emits:["search","reset","register","validate"],setup(e,{expose:a,emit:t}){const l=e,n=f(!0),o=f(l.model),s=v((()=>{const e=C(g);let a=fe(e.schema);if(e.showExpand&&e.expandField&&!C(n)){const t=pe(a,(a=>a.field===e.expandField));a.map(((e,a)=>(e.hidden=a>=t,e)))}return"inline"===e.layout&&(a=a.concat([{field:"action",formItemProps:{labelWidth:"0px",slots:{default:()=>x("div",null,[x(ia,{showSearch:e.showSearch,showReset:e.showReset,showExpand:e.showExpand,searchLoading:e.searchLoading,resetLoading:e.resetLoading,visible:n.value,onExpand:j,onReset:k,onSearch:S},null)])}}}])),a})),{formRegister:i,formMethods:r}=ze(),{getElFormExpose:c,getFormData:d,getFormExpose:u}=r,p=f({}),m=f({}),g=v((()=>{const e={...l};return Object.assign(e,C(m)),e}));h((()=>C(s)),(async(e=[])=>{o.value=je(e,C(o))}),{immediate:!0,deep:!0});const w=async()=>{const e=await d();return C(g).removeNoValueItem?Object.keys(e).reduce(((a,t)=>{const l=e[t];return me(l)||(ve(l)?Object.keys(l).length>0&&(a[t]=l):a[t]=l),a}),{}):e},S=async()=>{const e=await c();await(null==e?void 0:e.validate((async e=>{if(e){const e=await w();t("search",e)}})))},k=async()=>{const e=await c();null==e||e.resetFields();const a=await w();t("reset",a)},O=v((()=>({textAlign:C(g).buttonPosition}))),j=async()=>{n.value=!C(n)},E={getElFormExpose:c,setProps:(e={})=>{m.value=Object.assign(C(m),e),p.value=e},setSchema:e=>{const{schema:a}=C(g);for(const t of a)for(const a of e)t.field===a.field&&he(t,a.path,a.value)},setValues:async(e={})=>{o.value=Object.assign(l.model,C(o),e);const a=await u();null==a||a.setValues(e)},delSchema:e=>{const{schema:a}=C(g),t=pe(a,(a=>a.field===e));t>-1&&a.splice(t,1)},addSchema:(e,a)=>{const{schema:t}=C(g);void 0===a?t.push(e):t.splice(a,0,e)}};y((()=>{t("register",E)})),a(E);const L=(e,a,l)=>{t("validate",e,a,l)};return(a,t)=>(b(),I(T,null,[x(C(Ae),{model:o.value,"is-custom":!1,"label-width":g.value.labelWidth,"hide-required-asterisk":"",inline:g.value.inline,"is-col":g.value.isCol,schema:s.value,onRegister:C(i),onValidate:L},null,8,["model","label-width","inline","is-col","schema","onRegister"]),"bottom"===e.layout?(b(),I("div",{key:0,style:z(O.value)},[x(ia,{"show-reset":g.value.showReset,"show-search":g.value.showSearch,"show-expand":g.value.showExpand,"search-loading":g.value.searchLoading,"reset-loading":g.value.resetLoading,onExpand:j,onReset:k,onSearch:S},null,8,["show-reset","show-search","show-expand","search-loading","reset-loading"])],4)):A("",!0)],64))}});const ca=ye(),da=v((()=>ca.sizeMap)),{t:ua}=de(),fa=o({name:"TableActions",props:{columns:{type:Array,default:()=>[]}},emits:["refresh","changSize"],setup(e,{emit:a}){const t=()=>{a("refresh")},l=e=>{a("changSize",e)},n=v((()=>fe(e.columns).filter((e=>{if("selection"!==e.type&&"expand"!==e.type)return e}))));return h((()=>n.value),(e=>{console.log("columns change：",e)}),{deep:!0}),()=>x(T,null,[x("div",{class:"text-right h-28px flex items-center justify-end"},[x(Oe,{content:ua("common.refresh"),placement:"top"},{default:()=>[x("span",{onClick:t},[x(ce,{icon:"ant-design:sync-outlined",class:"cursor-pointer","hover-color":"var(--el-color-primary)"},null)])]}),x(Oe,{content:ua("common.size"),placement:"top"},{default:()=>[x(Fe,{trigger:"click",onCommand:l},{default:()=>x("span",null,[x(ce,{icon:"ant-design:column-height-outlined",class:"cursor-pointer mr-8px ml-8px","hover-color":"var(--el-color-primary)"},null)]),dropdown:()=>x(Pe,null,{default:()=>C(da).map((e=>{let a;return x($e,{key:e,command:e},"function"==typeof(t=a=ua(`size.${e}`))||"[object Object]"===Object.prototype.toString.call(t)&&!ge(t)?a:{default:()=>[a]});var t}))})})]})])])}});function pa(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!ge(e)}const ma=o({name:"Table",props:{pageSize:ne.number.def(10),currentPage:ne.number.def(1),showAction:ne.bool.def(!1),showOverflowTooltip:ne.bool.def(!0),columns:{type:Array,default:()=>[]},pagination:{type:Object,default:()=>{}},reserveSelection:ne.bool.def(!1),loading:ne.bool.def(!1),reserveIndex:ne.bool.def(!1),align:ne.string.validate((e=>["left","center","right"].includes(e))).def("left"),headerAlign:ne.string.validate((e=>["left","center","right"].includes(e))).def("left"),data:{type:Array,default:()=>[]},preview:{type:Array,default:()=>[]},height:ne.oneOfType([Number,String]),maxHeight:ne.oneOfType([Number,String]),stripe:ne.bool.def(!1),border:ne.bool.def(!0),size:{type:String,validator:e=>["medium","small","mini"].includes(e)},fit:ne.bool.def(!0),showHeader:ne.bool.def(!0),highlightCurrentRow:ne.bool.def(!1),currentRowKey:ne.oneOfType([Number,String]),rowClassName:{type:[Function,String],default:""},rowStyle:{type:[Function,Object],default:()=>{}},cellClassName:{type:[Function,String],default:""},cellStyle:{type:[Function,Object],default:()=>{}},headerRowClassName:{type:[Function,String],default:""},headerRowStyle:{type:[Function,Object],default:()=>{}},headerCellClassName:{type:[Function,String],default:""},headerCellStyle:{type:[Function,Object],default:()=>{}},rowKey:ne.string.def("id"),emptyText:ne.string.def("No Data"),defaultExpandAll:ne.bool.def(!1),expandRowKeys:{type:Array,default:()=>[]},defaultSort:{type:Object,default:()=>({})},tooltipEffect:{type:String,default:"dark"},tooltipOptions:{type:Object,default:()=>({enterable:!0,placement:"top",showArrow:!0,hideAfter:200,popperOptions:{strategy:"fixed"}})},showSummary:ne.bool.def(!1),sumText:ne.string.def("Sum"),summaryMethod:{type:Function,default:()=>{}},spanMethod:{type:Function,default:()=>{}},selectOnIndeterminate:ne.bool.def(!0),indent:ne.number.def(16),lazy:ne.bool.def(!1),load:{type:Function,default:()=>{}},treeProps:{type:Object,default:()=>({hasChildren:"hasChildren",children:"children",label:"label"})},tableLayout:{type:String,default:"fixed"},scrollbarAlwaysOn:ne.bool.def(!1),flexible:ne.bool.def(!1)},emits:["update:pageSize","update:currentPage","register","refresh","sortable-change"],setup(e,{attrs:a,emit:t,slots:l,expose:n}){const o=f();y((()=>{const e=C(o);t("register",null==e?void 0:e.$parent,o)}));const s=f(e.pageSize),i=f(e.currentPage),r=f({}),c=f({}),d=v((()=>{const a={...e};return Object.assign(a,C(c)),a})),u=(e={})=>{c.value=Object.assign(C(c),e),r.value={...e}},p=(e,a)=>{var t;const{columns:l}=C(d);for(const n of a||l)for(const a of e)n.field===a.field?he(n,a.path,a.value):(null==(t=n.children)?void 0:t.length)&&p(e,n.children)},m=()=>{t("refresh")},g=e=>{u({size:e})};n({setProps:u,setColumn:p,delColumn:e=>{const{columns:a}=C(d),t=a.findIndex((a=>a.field===e));t>-1&&a.splice(t,1)},addColumn:(e,a)=>{const{columns:t}=C(d);a?t.splice(a,0,e):t.push(e)},elTableRef:o});const b=v((()=>Object.assign({small:!1,background:!1,pagerCount:7,layout:"sizes, prev, pager, next, jumper, ->, total",pageSizes:[10,20,30,40,50,100],disabled:!1,hideOnSinglePage:!1,total:10},C(d).pagination)));h((()=>C(d).pageSize),(e=>{s.value=e})),h((()=>C(d).currentPage),(e=>{i.value=e})),h((()=>s.value),(e=>{t("update:pageSize",e)})),h((()=>i.value),(e=>{t("update:currentPage",e)}));const w=v((()=>{const e={...a,...C(d)};return delete e.columns,delete e.data,e})),S=e=>{const{align:a,headerAlign:t,showOverflowTooltip:l,preview:n}=C(d);return e.map((e=>{var o;if(e.hidden)return null;const s={...e};s.children&&delete s.children;const i=e.children,r={default:(...a)=>{var t,l;const o=a[0];let r=!1;return n.length&&(r=n.some((a=>a===e.field))),i&&i.length?S(i):(null==(t=null==s?void 0:s.slots)?void 0:t.default)?s.slots.default(a):(null==e?void 0:e.formatter)?null==(l=null==e?void 0:e.formatter)?void 0:l.call(e,o.row,o.column,we(o.row,e.field),o.$index):r?k(we(o.row,e.field)):we(o.row,e.field)}};return(null==(o=null==s?void 0:s.slots)?void 0:o.header)&&(r.header=(...e)=>s.slots.header(e)),x(Te,ee({showOverflowTooltip:l,align:a,headerAlign:t},s,{prop:e.field}),pa(r)?r:{default:()=>[r]})}))},k=e=>x("div",{class:"flex items-center"},[x(aa,{src:e,fit:"cover",class:"w-[100%] h-100px",lazy:!0,"preview-src-list":[e],"preview-teleported":!0},null)]);return()=>{const e={};return Ee(l,"empty")&&(e.empty=(...e)=>Ee(l,"empty",e)),Ee(l,"append")&&(e.append=(...e)=>Ee(l,"append",e)),D(x("div",null,[C(d).showAction?x(fa,{columns:C(d).columns,onChangSize:g,onRefresh:m},null):null,x(Ie,ee({ref:o,data:C(d).data},C(w)),{default:()=>(e=>{const{columns:a,reserveIndex:t,pageSize:l,currentPage:n,align:o,headerAlign:s,showOverflowTooltip:i,reserveSelection:r,preview:c}=C(d);return(e||a).map((e=>{var a;if(e.hidden)return null;if("index"===e.type)return x(Te,{type:"index",index:e.index?e.index:e=>((e,a,t,l)=>{const n=a+1;return e?t*(l-1)+n:n})(t,e,l,n),align:e.align||o,headerAlign:e.headerAlign||s,label:e.label,width:"65px"},null);if("selection"===e.type)return x(Te,{type:"selection",reserveSelection:r,align:o,headerAlign:s,width:"50"},null);{const t={...e};t.children&&delete t.children;const l=e.children,n={default:(...a)=>{var n,o;const s=a[0];let i=!1;return c.length&&(i=c.some((a=>a===e.field))),l&&l.length?S(l):(null==(n=null==t?void 0:t.slots)?void 0:n.default)?t.slots.default(a):(null==e?void 0:e.formatter)?null==(o=null==e?void 0:e.formatter)?void 0:o.call(e,s.row,s.column,we(s.row,e.field),s.$index):i?k(we(s.row,e.field)):we(s.row,e.field)}};return(null==(a=null==t?void 0:t.slots)?void 0:a.header)&&(n.header=(...e)=>t.slots.header(e)),x(Te,ee({showOverflowTooltip:i,align:o,headerAlign:s},t,{prop:e.field}),pa(n)?n:{default:()=>[n]})}}))})(),...e}),C(d).pagination?x(Re,ee({pageSize:s.value,"onUpdate:pageSize":e=>s.value=e,currentPage:i.value,"onUpdate:currentPage":e=>i.value=e,class:"mt-10px"},C(b)),null):void 0]),[[be("loading"),C(d).loading]])}}}),{t:va}=de(),ha=e=>{const{immediate:a=!0}=e,t=f(!1),l=f(1),n=f(10),o=f(0),s=f([]);h((()=>l.value),(()=>{d.getList()})),h((()=>n.value),(()=>{1===C(l)||(l.value=1),d.getList()})),y((()=>{a&&d.getList()}));const i=f(),r=f(),c=async()=>{await g();const e=C(i);return e||console.error("The table is not registered. Please use the register method to register"),e},d={getList:async()=>{t.value=!0;try{const a=await(null==e?void 0:e.fetchDataApi());a&&(s.value=a.list,o.value=a.total||0)}catch(a){console.log("fetchDataApi error")}finally{t.value=!1}},setProps:async(e={})=>{const a=await c();null==a||a.setProps(e)},setColumn:async e=>{const a=await c();null==a||a.setColumn(e)},addColumn:async(e,a)=>{const t=await c();null==t||t.addColumn(e,a)},delColumn:async e=>{const a=await c();null==a||a.delColumn(e)},getElTableExpose:async()=>(await c(),C(r)),refresh:()=>{d.getList()},delList:async a=>{const{fetchDelApi:t}=e;t?Me.confirm(va("common.delMessage"),va("common.delWarning"),{confirmButtonText:va("common.delOk"),cancelButtonText:va("common.delCancel"),type:"warning"}).then((async()=>{if(await t()){xe.success(va("common.delSuccess"));const e=(C(o)%C(n)===a||1===C(n))&&C(l)>1?C(l)-1:C(l);l.value=e,d.getList()}})):console.warn("fetchDelApi is undefined")}};return{tableRegister:(e,a)=>{i.value=e,r.value=C(a)},tableMethods:d,tableState:{currentPage:l,pageSize:n,total:o,dataList:s,loading:t}}},ga=e=>{const a=Se({searchSchema:[],tableColumns:[],formSchema:[],detailSchema:[]}),t=ya(e);a.searchSchema=t||[];const l=ba(e);a.tableColumns=l||[];const n=wa(e);a.formSchema=n;const o=xa(e);return a.detailSchema=o,{allSchemas:a}},ya=e=>{var a,t;const l=[],n=e.length;for(let o=0;o<n;o++){const n=e[o];if(!(null==(a=null==n?void 0:n.search)?void 0:a.hidden)){const e={component:(null==(t=null==n?void 0:n.search)?void 0:t.component)||"Input",...n.search,field:n.field,label:n.label};delete e.hidden,l.push(e)}}return l},ba=e=>{const a=Be(e,{conversion:e=>{var a;if(!(null==(a=null==e?void 0:e.table)?void 0:a.hidden))return{...e.table,...e}}});return De(a,(e=>(void 0===e.children&&delete e.children,!!e.field)))},wa=e=>{var a,t;const l=[],n=e.length;for(let o=0;o<n;o++){const n=e[o];if(!(null==(a=null==n?void 0:n.form)?void 0:a.hidden)){const e={component:(null==(t=null==n?void 0:n.form)?void 0:t.component)||"Input",...n.form,field:n.field,label:n.label};delete e.hidden,l.push(e)}}return l},xa=e=>{const a=[];return Ye(e,(e=>{var t,l;if(!(null==(t=null==e?void 0:e.detail)?void 0:t.hidden)){const t={...e.detail,field:e.field,label:(null==(l=e.detail)?void 0:l.label)||e.label};delete t.hidden,a.push(t)}})),a};export{ra as _,ga as a,ma as b,oa as c,ha as u};
