import{d as e,u as a,q as s,r as l,z as i,A as t,o,i as d,w as r,e as n,a as m,s as u,B as p,c,F as _,C as v,x as y,v as f,_ as h}from"./index-5daae5c6.js";import{C as b}from"./ContentDetailWrap-75ea7bde.js";import{u as g}from"./useEmitt-7829992f.js";import{g as j,a as w,u as V,b as k}from"./index-ceb4a7c4.js";import{g as q}from"./index-33a79b05.js";import{E as x,a as C}from"./el-form-item-ada12a4e.js";import{E}from"./el-button-4a7b0ca2.js";import{E as F}from"./el-input-d215ca9f.js";import{E as U,a as z}from"./el-select-03ddc29b.js";import"./el-popper-8a023621.js";import"./index-5f2b1643.js";const B=h(e({__name:"add",setup(e){const{push:h,go:B}=a();g();const G=s({season_year:[{required:!0,message:"team name is required",trigger:"blur"}],mvp:[{required:!0,message:"coach name is required",trigger:"blur"}],champion_team:[{required:!0,message:"start_year are required",trigger:"blur"}]}),R=l(),S=l([]),A=l([]),{query:D}=i(),H=l(!1),I=l(!1),M=s({season_id:"",champion_teamid:"",mvp:"",player_id:"",season_year:""});D.id&&(async()=>{I.value=!0;const e=await j({season_id:D.id});if(console.log("res_data",e),e){let a=null==e?void 0:e.items[0];Object.assign(M,a),I.value=!1}})();(async()=>{const e=await q();S.value=null==e?void 0:e.items.map((e=>({id:e.team_id,name:e.team_name})))})();(async()=>{const e=await w();A.value=null==e?void 0:e.items.map((e=>({id:e.player_id,name:e.name})))})();return(e,a)=>{const s=t("loading");return o(),d(m(b),{title:m(D).id?"edit":"add",onBack:a[6]||(a[6]=e=>m(h)("/season/list"))},{header:r((()=>[n(m(E),{onClick:a[0]||(a[0]=e=>m(B)(-1))},{default:r((()=>[u("Go")])),_:1})])),default:r((()=>[p((o(),d(m(x),{ref_key:"ruleFormRef",ref:R,model:M,rules:G,"label-width":"120px",class:"demo-ruleForm",size:"default","status-icon":""},{default:r((()=>[n(m(C),{label:"Season year",prop:"season_year"},{default:r((()=>[n(m(F),{modelValue:M.season_year,"onUpdate:modelValue":a[1]||(a[1]=e=>M.season_year=e),class:"width-190",placeholder:"place input",disabled:!!m(D).id},null,8,["modelValue","disabled"])])),_:1}),n(m(C),{label:"champion team "},{default:r((()=>[n(m(U),{modelValue:M.champion_teamid,"onUpdate:modelValue":a[2]||(a[2]=e=>M.champion_teamid=e),class:"width-190",placeholder:"select team name"},{default:r((()=>[(o(!0),c(_,null,v(S.value,(e=>(o(),d(m(z),{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),n(m(C),{label:"MVP "},{default:r((()=>[n(m(U),{modelValue:M.player_id,"onUpdate:modelValue":a[3]||(a[3]=e=>M.player_id=e),class:"width-190",placeholder:"select team name"},{default:r((()=>[(o(!0),c(_,null,v(A.value,(e=>(o(),d(m(z),{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),n(m(C),null,{default:r((()=>[n(m(E),{type:"primary",onClick:a[4]||(a[4]=e=>(async e=>{e&&await e.validate((async(e,a)=>{var s;if(e){console.log("ruleForm=",M),H.value=!0;let e=A.value.filter((e=>M.player_id==e.id));M.mvp=(null==(s=e[0])?void 0:s.name)??"";const a={champion_teamid:M.champion_teamid,mvp:M.mvp,player_id:M.player_id,season_year:M.season_year};let l;if(D.id){const e={season_id:M.season_id,champion_teamid:M.champion_teamid,mvp:M.mvp,player_id:M.player_id,season_year:M.season_year};l=await V(e).catch((()=>{})).finally((()=>{H.value=!1}))}else l=await k(a).catch((()=>{})).finally((()=>{H.value=!1}));l&&(f.success(D.id?"update success":"save success"),h("/season/list"))}else console.log("error submit!",a)}))})(R.value))},{default:r((()=>[u("Save")])),_:1}),m(D).id?y("v-if",!0):(o(),d(m(E),{key:0,onClick:a[5]||(a[5]=e=>{var a;(a=R.value)&&a.resetFields()})},{default:r((()=>[u("Reset")])),_:1}))])),_:1})])),_:1},8,["model","rules"])),[[s,I.value]])])),_:1},8,["title"])}}}),[["__file","/Users/zyb-dong/iit/cs425/dbproject/frontend/src/views/season/add.vue"]]);export{B as default};
