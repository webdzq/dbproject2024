import{d as e,u as a,q as l,r as s,z as d,A as t,o as m,i,w as r,e as o,a as u,s as _,B as n,c,F as p,C as g,x as f,v as w,_ as v}from"./index-5daae5c6.js";import{C as y}from"./ContentDetailWrap-75ea7bde.js";import{u as b}from"./useEmitt-7829992f.js";import{g as h,u as V,a as q}from"./index-a6d3710f.js";import{g as j,b as k}from"./index-33a79b05.js";import{E as x,a as U}from"./el-form-item-ada12a4e.js";import{E as C}from"./el-button-4a7b0ca2.js";import{E}from"./el-input-d215ca9f.js";import{E as F,a as z}from"./el-select-03ddc29b.js";import"./el-popper-8a023621.js";import"./index-5f2b1643.js";const B=v(e({__name:"add",setup(e){const{push:v,go:B}=a();b();const G=l({game_season:[{required:!0,message:"team name is required",trigger:"blur"}],game_date:[{required:!0,message:"game_date is required",trigger:"blur"}],stadium_name:[{required:!0,message:"stadium_name are required",trigger:"blur"}],home_team:[{required:!0,message:"stadium_name are required",trigger:"blur"}],away_team:[{required:!0,message:"stadium_name are required",trigger:"blur"}],score_winner:[{required:!0,message:"stadium_name are required",trigger:"blur"}],score_loser:[{required:!0,message:"stadium_name are required",trigger:"blur"}]}),O=s(),R=s([]),A=s([]),{query:D}=d(),H=s(!1),I=s(!1),K=l({game_season:"",stadium_id:"",team_home_id:"",team_away_id:"",stadium_name:"",home_team:"",away_team:"",score_winner:"",score_loser:"",game_date:""});D.id&&(async()=>{I.value=!0;const e=await h({game_id:D.id});if(console.log("res_data",e),e){let a=null==e?void 0:e.items[0];Object.assign(K,a),I.value=!1}})();(async()=>{const e=await j();R.value=null==e?void 0:e.items.map((e=>({id:e.team_id,name:e.team_name})))})();(async()=>{const e=await k();A.value=null==e?void 0:e.items.map((e=>({id:e.stadium_id,name:e.stadium_name}))),console.log("stadiumOptions.value",A.value)})();return(e,a)=>{const l=t("loading");return m(),i(u(y),{title:u(D).id?"edit":"add",onBack:a[10]||(a[10]=e=>u(v)("/game/list"))},{header:r((()=>[o(u(C),{onClick:a[0]||(a[0]=e=>u(B)(-1))},{default:r((()=>[_("Go")])),_:1})])),default:r((()=>[n((m(),i(u(x),{ref_key:"ruleFormRef",ref:O,model:K,rules:G,"label-width":"120px",class:"demo-ruleForm",size:"default","status-icon":""},{default:r((()=>[o(u(U),{label:"Game season",prop:"game_season"},{default:r((()=>[o(u(E),{modelValue:K.game_season,"onUpdate:modelValue":a[1]||(a[1]=e=>K.game_season=e),class:"width-190",placeholder:"place input",disabled:!!u(D).id},null,8,["modelValue","disabled"])])),_:1}),o(u(U),{label:"game date",prop:"game_date"},{default:r((()=>[o(u(E),{modelValue:K.game_date,"onUpdate:modelValue":a[2]||(a[2]=e=>K.game_date=e),class:"width-190",placeholder:"place input date,format:yyyy-mm-dd"},null,8,["modelValue"])])),_:1}),o(u(U),{label:"stadium_name "},{default:r((()=>[o(u(F),{modelValue:K.stadium_id,"onUpdate:modelValue":a[3]||(a[3]=e=>K.stadium_id=e),class:"width-190",placeholder:"select team name"},{default:r((()=>[(m(!0),c(p,null,g(A.value,(e=>(m(),i(u(z),{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),o(u(U),{label:"home_team "},{default:r((()=>[o(u(F),{modelValue:K.team_home_id,"onUpdate:modelValue":a[4]||(a[4]=e=>K.team_home_id=e),class:"width-190",placeholder:"select team name"},{default:r((()=>[(m(!0),c(p,null,g(R.value,(e=>(m(),i(u(z),{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),o(u(U),{label:"away_team "},{default:r((()=>[o(u(F),{modelValue:K.team_away_id,"onUpdate:modelValue":a[5]||(a[5]=e=>K.team_away_id=e),class:"width-190",placeholder:"select team name"},{default:r((()=>[(m(!0),c(p,null,g(R.value,(e=>(m(),i(u(z),{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),o(u(U),{label:"score_winner",prop:"score_winner"},{default:r((()=>[o(u(E),{modelValue:K.score_winner,"onUpdate:modelValue":a[6]||(a[6]=e=>K.score_winner=e),class:"width-190",placeholder:"place iput",type:"number"},null,8,["modelValue"])])),_:1}),o(u(U),{label:"score_loser",prop:"score_loser"},{default:r((()=>[o(u(E),{modelValue:K.score_loser,"onUpdate:modelValue":a[7]||(a[7]=e=>K.score_loser=e),class:"width-190",placeholder:"place iput",type:"number"},null,8,["modelValue"])])),_:1}),o(u(U),null,{default:r((()=>[o(u(C),{type:"primary",onClick:a[8]||(a[8]=e=>(async e=>{e&&await e.validate((async(e,a)=>{if(e){console.log("ruleForm=",K),H.value=!0;const e={team_home_id:K.team_home_id,team_away_id:K.team_away_id,stadium_id:K.stadium_id,game_season:K.game_season,score_winner:K.score_winner,score_loser:K.score_loser,game_date:K.game_date};let a;if(D.id){const e={game_id:K.game_id,team_home_id:K.team_home_id,team_away_id:K.team_away_id,stadium_id:K.stadium_id,game_season:K.game_season,score_winner:K.score_winner,score_loser:K.score_loser,game_date:K.game_date};a=await V(e).catch((()=>{})).finally((()=>{H.value=!1}))}else a=await q(e).catch((()=>{})).finally((()=>{H.value=!1}));a&&(w.success(D.id?"update success":"save success"),v("/game/list"))}else console.log("error submit!",a)}))})(O.value))},{default:r((()=>[_("Save")])),_:1}),u(D).id?f("v-if",!0):(m(),i(u(C),{key:0,onClick:a[9]||(a[9]=e=>{var a;(a=O.value)&&a.resetFields()})},{default:r((()=>[_("Reset")])),_:1}))])),_:1})])),_:1},8,["model","rules"])),[[l,I.value]])])),_:1},8,["title"])}}}),[["__file","/Users/zyb-dong/iit/cs425/dbproject/frontend/src/views/game/add.vue"]]);export{B as default};
