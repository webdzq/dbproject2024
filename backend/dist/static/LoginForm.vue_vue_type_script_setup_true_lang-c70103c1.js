import{u as e,F as a}from"./useForm-aca3a07d.js";import{A as o,aA as s,d as l,H as t,G as r,o as n,c as i,i as d,w as c,ae as u,a as p,C as m,P as f,n as g,O as h,B as v,S as y,b,m as w,u as P,s as k,e as R,F as I,ar as j,r as x,V as C,aM as E,aN as A,aO as z,ax as F,aP as _,k as N}from"./index-d5304777.js";import{E as S}from"./el-button-7384c59f.js";import{E as O}from"./el-checkbox-b2c1ef9f.js";import{u as V}from"./useValidator-abf1376c.js";const $=o({type:{type:String,values:["primary","success","warning","info","danger","default"],default:"default"},underline:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},href:{type:String,default:""},icon:{type:s}}),q={click:e=>e instanceof MouseEvent},B=["href"],D=l({name:"ElLink"});const L=y(v(l({...D,props:$,emits:q,setup(e,{emit:a}){const o=e,s=t("link"),l=r((()=>[s.b(),s.m(o.type),s.is("disabled",o.disabled),s.is("underline",o.underline&&!o.disabled)]));function v(e){o.disabled||a("click",e)}return(e,a)=>(n(),i("a",{class:g(p(l)),href:e.disabled||!e.href?void 0:e.href,onClick:v},[e.icon?(n(),d(p(m),{key:0},{default:c((()=>[(n(),d(u(e.icon)))])),_:1})):f("v-if",!0),e.$slots.default?(n(),i("span",{key:1,class:g(p(s).e("inner"))},[h(e.$slots,"default")],2)):f("v-if",!0),e.$slots.icon?h(e.$slots,"icon",{key:2}):f("v-if",!0)],10,B))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/link/src/link.vue"]]));function M(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!F(e)}const U="#999",G="var(--el-color-primary)",H=l({__name:"LoginForm",setup(o){const{required:s}=V(),l=b(),t=w(),{currentRoute:r,addRoute:i,push:c}=P(),{setStorage:u}=_(),{t:m}=N(),f={username:[s()],password:[s()]},g=k([{field:"title",colProps:{span:24},formItemProps:{slots:{default:()=>R("h2",{class:"text-2xl font-bold text-center w-[100%]"},[m("login.login")])}}},{field:"username",label:m("login.username"),value:"admin",component:"Input",colProps:{span:24},componentProps:{placeholder:m("login.usernamePlaceholder")}},{field:"password",label:m("login.password"),value:"admin",component:"InputPassword",colProps:{span:24},componentProps:{style:{width:"100%"},placeholder:m("login.passwordPlaceholder")}},{field:"tool",colProps:{span:24},formItemProps:{slots:{default:()=>{let e;return R(I,null,[R("div",{class:"flex justify-between items-center w-[100%]"},[R(O,{modelValue:h.value,"onUpdate:modelValue":e=>h.value=e,label:m("login.remember"),size:"small"},null),R(L,{type:"primary",underline:!1},M(e=m("login.forgetPassword"))?e:{default:()=>[e]})])])}}}},{field:"login",colProps:{span:24},formItemProps:{slots:{default:()=>{let e;return R(I,null,[R("div",{class:"w-[100%]"},[R(S,{loading:q.value,type:"primary",class:"w-[100%]",onClick:D},M(e=m("login.login"))?e:{default:()=>[e]})])])}}}},{field:"other",component:"Divider",label:m("login.otherLogin"),componentProps:{contentPosition:"center"}},{field:"otherIcon",colProps:{span:24},formItemProps:{slots:{default:()=>R(I,null,[R("div",{class:"flex justify-between w-[100%]"},[R(j,{icon:"ant-design:github-filled",size:30,class:"cursor-pointer ant-icon",color:U,hoverColor:G},null),R(j,{icon:"ant-design:wechat-filled",size:30,class:"cursor-pointer ant-icon",color:U,hoverColor:G},null),R(j,{icon:"ant-design:alipay-circle-filled",size:30,color:U,hoverColor:G,class:"cursor-pointer ant-icon"},null),R(j,{icon:"ant-design:weibo-circle-filled",size:30,color:U,hoverColor:G,class:"cursor-pointer ant-icon"},null)])])}}}]),h=x(!1),{formRegister:v,formMethods:y}=e(),{getFormData:F,getElFormExpose:$}=y,q=x(!1),B=x("");C((()=>r.value),(e=>{var a;B.value=null==(a=null==e?void 0:e.query)?void 0:a.redirect}),{immediate:!0});const D=async()=>{const e=await $();await(null==e?void 0:e.validate((async e=>{if(e){q.value=!0;try{const e=await E();e&&(l.setUserInfo(e.data),l.getDynamicRouter?H():(await t.generateRoutes("none").catch((()=>{})),t.getAddRouters.forEach((e=>{i(e)})),t.setIsAddRouters(!0),c({path:B.value||t.addRouters[0].path})))}finally{q.value=!1}}})))},H=async()=>{const e=await F(),a={roleName:e.realName},o="admin"===e.realName?await A(a):await z(a);if(o){const a=o.data||[];u("roleRouters",a),"admin"===e.realName?await t.generateRoutes("admin",a).catch((()=>{})):await t.generateRoutes("test",a).catch((()=>{})),t.getAddRouters.forEach((e=>{i(e)})),t.setIsAddRouters(!0),c({path:B.value||t.addRouters[0].path})}};return(e,o)=>(n(),d(p(a),{schema:g,rules:f,"label-position":"top","hide-required-asterisk":"",size:"large",class:"dark:border-1 dark:border-[var(--el-border-color)] dark:border-solid",onRegister:p(v)},null,8,["schema","onRegister"]))}});export{H as _};
