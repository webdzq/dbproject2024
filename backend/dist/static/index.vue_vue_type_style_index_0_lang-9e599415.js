import{d as e,r as l,s as a,V as o,o as t,i as s,w as i,e as p,a as r,x as d,P as m,f as u,t as n}from"./index-d5304777.js";import{E as f}from"./el-card-2b130a3f.js";import{E as c,a as g}from"./el-form-item-38df9850.js";import{E as h}from"./el-input-18a8a90e.js";import{E as v}from"./el-button-7384c59f.js";import{E as w}from"./el-row-da9cc34b.js";import{E as b,a as j}from"./el-table-column-0c648863.js";import"./el-checkbox-b2c1ef9f.js";import"./el-popper-20328552.js";import{d as _}from"./el-tag-377e0f90.js";import{E as z}from"./el-pagination-60cf2577.js";import"./el-select-ce060cba.js";import{a as k}from"./index-98d51863.js";const y=["href"],I=e({__name:"index",props:{isShow:{type:Boolean,default:!1},isChoose:{type:Boolean,default:!1},defaultList:{default:null},apkId:{}},setup(e,{expose:I}){const U=e,V=l(),x=l([]),E=l(0),C=l([]),N=a({moduleName:"",commitId:"",pageUrl:""}),S=l([]),L=l(1),M=l(8),T=l(0);U.isChoose&&o((()=>U.isShow),(e=>{var l,a;e?0!==(null==(l=U.defaultList)?void 0:l.length)&&(null==(a=U.defaultList)||a.forEach((e=>{setTimeout((()=>{V.value.toggleRowSelection(e,!0)}),0)}))):(N.commitId="",N.moduleName="",N.pageUrl="",V.value.clearSelection())}),{immediate:!0});const Y=e=>{L.value=e,R()},D=e=>e.id,B=e=>{x.value=e,E.value=x.value.length,C.value=[],e&&e.forEach((e=>{e&&C.value.push(e.id)})),console.log(C.value)},H=()=>{Y(1)},R=async()=>{const e={...N,page:L.value,limit:M.value};U.apkId&&(e.apkId=U.apkId);const l=await k(e);T.value=l.meta.total,S.value=l.items};R();return I({getSelectionList:()=>x.value}),o((()=>U.apkId),(e=>{e&&H()})),(e,l)=>(t(),s(r(f),{class:"zip-page"},{header:i((()=>[p(r(c),{model:N,inline:!0,"label-width":"80"},{default:i((()=>[p(r(g),{label:"模块名称"},{default:i((()=>[p(r(h),{modelValue:N.moduleName,"onUpdate:modelValue":l[0]||(l[0]=e=>N.moduleName=e)},null,8,["modelValue"])])),_:1}),p(r(g),{label:"commitId"},{default:i((()=>[p(r(h),{modelValue:N.commitId,"onUpdate:modelValue":l[1]||(l[1]=e=>N.commitId=e)},null,8,["modelValue"])])),_:1}),p(r(g),{label:"页面链接"},{default:i((()=>[p(r(h),{modelValue:N.pageUrl,"onUpdate:modelValue":l[2]||(l[2]=e=>N.pageUrl=e)},null,8,["modelValue"])])),_:1}),p(r(v),{type:"primary",size:"large",class:"search-zip-btn",round:"",onClick:H},{default:i((()=>[d("搜索")])),_:1})])),_:1},8,["model"])])),default:i((()=>[p(r(b),{data:S.value,border:"",style:{width:"100%"},"row-key":D,onSelectionChange:B,ref_key:"multipleTableRef",ref:V,class:"zip-table"},{default:i((()=>[e.isChoose?(t(),s(r(j),{key:0,type:"selection",width:"55","reserve-selection":!0})):m("",!0),p(r(j),{prop:"id",label:"id",width:"55"}),p(r(j),{prop:"pageName",label:"页面名称"}),p(r(j),{prop:"pageUrl",label:"页面链接","show-overflow-tooltip":!0}),p(r(j),{prop:"zipUrl",label:"zip链接","show-overflow-tooltip":!0},{default:i((e=>[u("a",{href:e.row.zipUrl},n(e.row.zipUrl),9,y)])),_:1}),p(r(j),{prop:"pkgVersion",label:"版本号",width:"80"}),p(r(j),{prop:"zipMd5",label:"md5","show-overflow-tooltip":!0}),p(r(j),{prop:"commitId",label:"commitId","show-overflow-tooltip":!0}),p(r(j),{prop:"moduleName",label:"模块名称","show-overflow-tooltip":!0}),p(r(j),{prop:"updatedTime",label:"更新时间"},{default:i((e=>[d(n(r(_)(e.row.updatedTime).format("YYYY/MM/DD HH:mm:ss")),1)])),_:1})])),_:1},8,["data"]),p(r(w),{justify:"end",class:"zip-pagination"},{default:i((()=>[p(r(z),{background:"",layout:"prev, pager, next","page-size":M.value,total:T.value,"current-page":L.value,onCurrentChange:Y},null,8,["page-size","total","current-page"])])),_:1})])),_:1}))}});export{I as _};
